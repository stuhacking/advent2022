<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-12-05 Mon 16:51 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Advent of Code 2022</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Stu">
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Advent of Code 2022</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc7b468b">Introduction</a></li>
<li><a href="#orgb170d70">Ch 1: Calorie Counting</a>
<ul>
<li><a href="#orga809a74"><span class="done DONE">DONE</span> Part One</a></li>
<li><a href="#orgbcc0a3e"><span class="done DONE">DONE</span> Part Two</a></li>
</ul>
</li>
<li><a href="#orgc601edb">Ch 2: Rock Paper Scissors</a>
<ul>
<li><a href="#org0f80769"><span class="done DONE">DONE</span> Part One</a></li>
<li><a href="#org33f9490"><span class="done DONE">DONE</span> Part Two</a></li>
</ul>
</li>
<li><a href="#org660cabb">Ch 3: Rucksack Reorganisation</a>
<ul>
<li><a href="#orgb4fbac3"><span class="done DONE">DONE</span> Part One</a></li>
<li><a href="#org33c732f"><span class="done DONE">DONE</span> Part Two</a></li>
</ul>
</li>
<li><a href="#orgfae93e5">Ch 4: Camp Cleanup</a>
<ul>
<li><a href="#org7d1ad6c"><span class="done DONE">DONE</span> Part One</a></li>
<li><a href="#org5e4ec92"><span class="done DONE">DONE</span> Part Two</a></li>
</ul>
</li>
<li><a href="#org966ddee">Ch 5: Supply Stacks</a>
<ul>
<li><a href="#orgb3d3885"><span class="done DONE">DONE</span> Part One</a></li>
<li><a href="#orgcde1b4e"><span class="done DONE">DONE</span> Part Two</a></li>
</ul>
</li>
<li><a href="#org870090d">Ch 6: &#x2026;</a></li>
<li><a href="#org85c3d85">Ch 7: &#x2026;</a></li>
<li><a href="#org58001d9">Ch 8: &#x2026;</a></li>
<li><a href="#orgbc540f5">Ch 9: &#x2026;</a></li>
<li><a href="#orgbc1c6b7">Ch 10: &#x2026;</a></li>
<li><a href="#org0f842fc">Ch 11: &#x2026;</a></li>
<li><a href="#orga79e3f3">Ch 12: &#x2026;</a></li>
<li><a href="#org83bbe6c">Ch 13: &#x2026;</a></li>
<li><a href="#orgeff7887">Ch 14: &#x2026;</a></li>
<li><a href="#org43d70c8">Ch 15: &#x2026;</a></li>
<li><a href="#org562057c">Ch 16: &#x2026;</a></li>
<li><a href="#org1864728">Ch 17: &#x2026;</a></li>
<li><a href="#orgc9a17c3">Ch 18: &#x2026;</a></li>
<li><a href="#orgc8529bd">Ch 19: &#x2026;</a></li>
<li><a href="#orgaf2ba77">Ch 20: &#x2026;</a></li>
<li><a href="#orgede2c3e">Ch 21: &#x2026;</a></li>
<li><a href="#org1ef22bd">Ch 22: &#x2026;</a></li>
<li><a href="#orgb984390">Ch 23: &#x2026;</a></li>
<li><a href="#org179240e">Ch 24: &#x2026;</a></li>
<li><a href="#org32a61c7">Ch 25: &#x2026;</a></li>
<li><a href="#org2a62123">References</a></li>
<li><a href="#org0a10fe1">Appendix A: Helper Definitions</a></li>
<li><a href="#orgf55527b">Appendix B: Example Chapter</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgc7b468b" class="outline-2">
<h2 id="orgc7b468b">Introduction</h2>
<div class="outline-text-2" id="text-orgc7b468b">
<p>
<a href="https://adventofcode.com/2022">Advent of Code 2022</a> literate Clojure. To run code blocks in this file, you'll
probably want to have a recent version of <a href="http://gnu.org/software/emacs">Emacs</a> with <a href="http://orgmode.org">Org-Mode</a> 9 or later, and
<a href="http://cider.mx">Cider</a> installed to start up the Clojure REPL.
</p>

<p>
Some of the problems might be stand-alone and some might build on earlier
solutions. In the past each day has usually had a couple of variations on a
problem's theme, e.g. a simpler and a tougher challenge. For this reason, I'm
not initially going to tangle the code into different packages. Just run
<code>cider-jack-in</code> to start the REPL and then evaluate the code in the <code>*user*</code>
namespace.
</p>
</div>
</div>

<div id="outline-container-orgb170d70" class="outline-2">
<h2 id="orgb170d70">Ch 1: Calorie Counting</h2>
<div class="outline-text-2" id="text-orgb170d70">
<p>
Santa's reindeer typically eat regular reindeer food, but they need a lot of
<i>magical energy</i> to deliver presents on Christmas. For that, their favorite
snack is a special type of <b>star</b> fruit that only grows deep in the jungle. The
Elves have brought you on their annual expedition to the grove where the fruit
grows.
</p>

<p>
To supply enough magical energy, the expedition needs to retrieve a minimum of
<b>fifty stars</b> by December 25th. Although the Elves assure you that the grove has
plenty of fruit, you decide to grab any fruit you see along the way, just in
case.
</p>

<p>
Collect stars by solving puzzles. Two puzzles will be made available on each
day in the Advent calendar; the second puzzle is unlocked when you complete
the first. Each puzzle grants <b>one star</b>. Good luck!
</p>
</div>

<div id="outline-container-orga809a74" class="outline-3">
<h3 id="orga809a74"><span class="done DONE">DONE</span> Part One</h3>
<div class="outline-text-3" id="text-orga809a74">
<p>
The jungle must be too overgrown and difficult to navigate in vehicles or
access from the air; the Elves' expedition traditionally goes on foot. As your
boats approach land, the Elves begin taking inventory of their supplies. One
important consideration is food - in particular, the number of <i>Calories</i> each
Elf is carrying (your puzzle input).
</p>

<p>
The Elves take turns writing down the number of Calories contained by the
various meals, snacks, rations, etc. that they've brought with them, one item
per line. Each Elf separates their own inventory from the previous Elf's
inventory (if any) by a blank line.
</p>

<p>
For example, suppose the Elves finish writing their items' Calories and end up
with the following list:
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="org3c78d63"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">day1-data</span> <span style="color: #d33682;">(</span>slurp <span style="color: #2aa198;">"resources/day1_input.txt"</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">elf-inventory</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> <span style="color: #859900;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split day1-data #<span style="color: #2aa198;">"</span><span style="color: #2aa198; font-weight: bold;">\n\n</span><span style="color: #2aa198;">"</span><span style="color: #859900;">)</span>
       <span style="color: #859900;">(</span>map <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">fn</span> <span style="color: #35a69c;">[</span>coll<span style="color: #35a69c;">]</span> <span style="color: #35a69c;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split-lines coll<span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span>
       <span style="color: #859900;">(</span>mapv #<span style="color: #6c71c4;">(</span>mapv <span style="color: #35a69c;">(</span><span style="color: #859900; font-weight: bold;">fn</span> <span style="color: #268bd2;">[</span>x<span style="color: #268bd2;">]</span> <span style="color: #268bd2;">(</span><span style="color: #b58900; font-style: italic;">Integer</span>/parseInt x<span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span> <span style="color: #268bd2;">%</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
This list represents the Calories of the food carried by five Elves, e.g:
</p>

<ul class="org-ul">
<li>The first Elf is carrying food with 1000, 2000, and 3000 Calories, a total
of <i>6000</i> Calories.</li>
<li>The second Elf is carrying one food item with <i>4000</i> Calories.</li>
<li>The third Elf is carrying food with 5000 and 6000 Calories, a total of <i>11000</i>
Calories.</li>
<li>The fourth Elf is carrying food with 7000, 8000, and 9000 Calories, a total
of <i>24000</i> Calories.</li>
<li>The fifth Elf is carrying one food item with <i>10000</i> Calories.</li>
</ul>

<p>
In case the Elves get hungry and need extra snacks, they need to know which
Elf to ask: they'd like to know how many Calories are being carried by the Elf
carrying the <i>most</i> Calories. In the example above, this is <i>24000</i> (carried by
the fourth Elf).
</p>

<p>
Find the Elf carrying the most Calories. <i>How many total Calories is that Elf
carrying?</i>
</p>

<p>
Alright then elves, everyone sum up the amount you're carrying.
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="org4c925e5"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">elf-totals</span>
  <span style="color: #d33682;">(</span>mapv #<span style="color: #859900;">(</span>reduce + <span style="color: #268bd2;">%</span><span style="color: #859900;">)</span> elf-inventory<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
Now, who has the most <i>calories</i> here, how many?
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="orgf30ba6a"><span style="color: #268bd2;">(</span>reduce max elf-totals<span style="color: #268bd2;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbcc0a3e" class="outline-3">
<h3 id="orgbcc0a3e"><span class="done DONE">DONE</span> Part Two</h3>
<div class="outline-text-3" id="text-orgbcc0a3e">
<p>
By the time you calculate the answer to the Elves' question, they've already
realized that the Elf carrying the most Calories of food might eventually <i>run
out of snacks</i>.
</p>

<p>
To avoid this unacceptable situation, the Elves would instead like to know
the total Calories carried by the <i>top three</i> Elves carrying the most
Calories. That way, even if one of those Elves runs out of snacks, they still
have two backups.
</p>

<p>
In the example above, the top three Elves are the fourth Elf (with 24000
Calories), then the third Elf (with 11000 Calories), then the fifth Elf (with
10000 Calories). The sum of the Calories carried by these three elves
is <i>45000</i>.
</p>

<p>
Find the top three Elves carrying the most Calories. <i>How many Calories are
those Elves carrying in total?</i>
</p>

<p>
Alright then elves, line up in order of how much snacks you brought, then the
three at the front can sum up their amounts.
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="orgabc6255"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">sorted-elves</span>
  <span style="color: #d33682;">(</span>reverse <span style="color: #859900;">(</span>sort elf-totals<span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure" id="org885f614"><span style="color: #268bd2;">(</span>reduce + <span style="color: #d33682;">(</span>take 3  sorted-elves<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgc601edb" class="outline-2">
<h2 id="orgc601edb">Ch 2: Rock Paper Scissors</h2>
<div class="outline-text-2" id="text-orgc601edb">
<p>
The Elves begin to set up camp on the beach. To decide whose tent gets to be
closest to the snack storage, a giant <b>Rock Paper Scissors</b> tournament is
already in progress.
</p>

<p>
Rock Paper Scissors is a game between two players. Each game contains many
rounds; in each round, the players each simultaneously choose one of Rock,
Paper, or Scissors using a hand shape. Then, a winner for that round is
selected: Rock defeats Scissors, Scissors defeats Paper, and Paper defeats
Rock. If both players choose the same shape, the round instead ends in a draw.
</p>
</div>

<div id="outline-container-org0f80769" class="outline-3">
<h3 id="org0f80769"><span class="done DONE">DONE</span> Part One</h3>
<div class="outline-text-3" id="text-org0f80769">
<p>
Appreciative of your help yesterday, one Elf gives you an <i>encrypted strategy
guide</i> (your puzzle input) that they say will be sure to help you win. "The
first column is what your opponent is going to play: A for Rock, B for Paper,
and C for Scissors. The second column&#x2013;" Suddenly, the Elf is called away to
help with someone's tent.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">day2-data</span> <span style="color: #d33682;">(</span>slurp <span style="color: #2aa198;">"resources/day2_input.txt"</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
The second column, you reason, must be what you should play in response: X for
Rock, Y for Paper, and Z for Scissors. Winning every time would be suspicious,
so the responses must have been carefully chosen.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">code-&gt;item</span>
  <span style="color: #d33682;">{</span><span style="color: #2aa198;">"A"</span> <span style="color: #6c71c4; font-weight: bold;">:rock</span>
   <span style="color: #2aa198;">"B"</span> <span style="color: #6c71c4; font-weight: bold;">:paper</span>
   <span style="color: #2aa198;">"C"</span> <span style="color: #6c71c4; font-weight: bold;">:scissors</span>
   <span style="color: #2aa198;">"X"</span> <span style="color: #6c71c4; font-weight: bold;">:rock</span>
   <span style="color: #2aa198;">"Y"</span> <span style="color: #6c71c4; font-weight: bold;">:paper</span>
   <span style="color: #2aa198;">"Z"</span> <span style="color: #6c71c4; font-weight: bold;">:scissors</span><span style="color: #d33682;">}</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">rounds</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> <span style="color: #859900;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split-lines day2-data<span style="color: #859900;">)</span>
       <span style="color: #859900;">(</span>mapv #<span style="color: #6c71c4;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split <span style="color: #268bd2;">%</span> #<span style="color: #2aa198;">"[ ]+"</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span>
       <span style="color: #859900;">(</span>mapv #<span style="color: #6c71c4;">(</span>mapv code-&gt;item <span style="color: #268bd2;">%</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>


<p>
The winner of the whole tournament is the player with the highest score. Your
<i>total score</i> is the sum of your scores for each round. The score for a single
round is the score for the <i>shape you selected</i> (1 for Rock, 2 for Paper, and 3
for Scissors) plus the score for the <i>outcome of the round</i> (0 if you lost, 3 if
the round was a draw, and 6 if you won).
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">score-round</span> <span style="color: #d33682;">[</span><span style="color: #859900;">[</span>response outcome<span style="color: #859900;">]</span><span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #859900;">[</span>item-scores <span style="color: #6c71c4;">{</span><span style="color: #6c71c4; font-weight: bold;">:rock</span> 1, <span style="color: #6c71c4; font-weight: bold;">:paper</span> 2, <span style="color: #6c71c4; font-weight: bold;">:scissors</span> 3<span style="color: #6c71c4;">}</span>
        outcome-scores <span style="color: #6c71c4;">{</span><span style="color: #6c71c4; font-weight: bold;">:win</span> 6, <span style="color: #6c71c4; font-weight: bold;">:draw</span> 3, <span style="color: #6c71c4; font-weight: bold;">:loss</span> 0<span style="color: #6c71c4;">}</span><span style="color: #859900;">]</span>
    <span style="color: #859900;">(</span>+ <span style="color: #6c71c4;">(</span>response item-scores<span style="color: #6c71c4;">)</span>
       <span style="color: #6c71c4;">(</span>outcome outcome-scores<span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">beats</span> <span style="color: #d33682;">[</span>a b<span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #859900;">(</span>= a b<span style="color: #859900;">)</span>
    <span style="color: #6c71c4; font-weight: bold;">:draw</span>
    <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">or</span> <span style="color: #35a69c;">(</span><span style="color: #859900; font-weight: bold;">and</span> <span style="color: #268bd2;">(</span>= a <span style="color: #6c71c4; font-weight: bold;">:rock</span><span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span>= b <span style="color: #6c71c4; font-weight: bold;">:scissors</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span>
            <span style="color: #35a69c;">(</span><span style="color: #859900; font-weight: bold;">and</span> <span style="color: #268bd2;">(</span>= a <span style="color: #6c71c4; font-weight: bold;">:scissors</span><span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span>= b <span style="color: #6c71c4; font-weight: bold;">:paper</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span>
            <span style="color: #35a69c;">(</span><span style="color: #859900; font-weight: bold;">and</span> <span style="color: #268bd2;">(</span>= a <span style="color: #6c71c4; font-weight: bold;">:paper</span><span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span>= b <span style="color: #6c71c4; font-weight: bold;">:rock</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span>
      <span style="color: #6c71c4; font-weight: bold;">:win</span>
      <span style="color: #6c71c4; font-weight: bold;">:loss</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">play-round</span> <span style="color: #d33682;">[</span>challenge response<span style="color: #d33682;">]</span>
  <span style="color: #d33682;">[</span>response <span style="color: #859900;">(</span>beats response challenge<span style="color: #859900;">)</span><span style="color: #d33682;">]</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
Since you can't be sure if the Elf is trying to help you or trick you, you
should calculate the score you would get if you were to follow the strategy
guide.
</p>

<p>
For example, suppose you were given the following strategy guide:
</p>

<pre class="example" id="org996bf31">
A Y
B X
C Z
</pre>

<p>
This strategy guide predicts and recommends the following:
</p>

<ul class="org-ul">
<li>In the first round, your opponent will choose Rock (A), and you should
choose Paper (Y). This ends in a win for you with a score of <i>8</i> (2 because
you chose Paper + 6 because you won).</li>
<li>In the second round, your opponent will choose Paper (B), and you should
choose Rock (X). This ends in a loss for you with a score of <i>1</i> (1 + 0).</li>
<li>The third round is a draw with both players choosing Scissors, giving you a
score of 3 + 3 = <i>6</i>.</li>
</ul>

<p>
In this example, if you were to follow the strategy guide, you would get a
total score of <i>15</i> (8 + 1 + 6).
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="org36003e8"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">for</span> <span style="color: #d33682;">[</span>round <span style="color: #859900;">[</span><span style="color: #6c71c4;">(</span>play-round <span style="color: #6c71c4; font-weight: bold;">:rock</span> <span style="color: #6c71c4; font-weight: bold;">:paper</span><span style="color: #6c71c4;">)</span>
             <span style="color: #6c71c4;">(</span>play-round <span style="color: #6c71c4; font-weight: bold;">:paper</span> <span style="color: #6c71c4; font-weight: bold;">:rock</span><span style="color: #6c71c4;">)</span>
             <span style="color: #6c71c4;">(</span>play-round <span style="color: #6c71c4; font-weight: bold;">:scissors</span> <span style="color: #6c71c4; font-weight: bold;">:scissors</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">]</span><span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span>format <span style="color: #2aa198;">"%s = %d"</span> round <span style="color: #859900;">(</span>score-round round<span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
What would your total score be if everything goes exactly according to your
strategy guide?
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="orgca7daca"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> rounds
     <span style="color: #d33682;">(</span>map #<span style="color: #859900;">(</span>apply play-round <span style="color: #268bd2;">%</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>map score-round<span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>reduce +<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org33f9490" class="outline-3">
<h3 id="org33f9490"><span class="done DONE">DONE</span> Part Two</h3>
<div class="outline-text-3" id="text-org33f9490">
<p>
The Elf finishes helping with the tent and sneaks back over to you. "Anyway,
the second column says how the round needs to end: X means you need to lose,
Y means you need to end the round in a draw, and Z means you need to
win. Good luck!"
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">code-&gt;outcome</span>
  <span style="color: #d33682;">{</span><span style="color: #2aa198;">"X"</span> <span style="color: #6c71c4; font-weight: bold;">:loss</span>
   <span style="color: #2aa198;">"Y"</span> <span style="color: #6c71c4; font-weight: bold;">:draw</span>
   <span style="color: #2aa198;">"Z"</span> <span style="color: #6c71c4; font-weight: bold;">:win</span><span style="color: #d33682;">}</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">round-strategies</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> <span style="color: #859900;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split-lines day2-data<span style="color: #859900;">)</span>
       <span style="color: #859900;">(</span>mapv #<span style="color: #6c71c4;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split <span style="color: #268bd2;">%</span> #<span style="color: #2aa198;">"[ ]+"</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span>
       <span style="color: #859900;">(</span>mapv <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">fn</span> <span style="color: #35a69c;">[</span>x<span style="color: #35a69c;">]</span> <span style="color: #35a69c;">[</span><span style="color: #268bd2;">(</span>code-&gt;item <span style="color: #d33682;">(</span>nth x 0<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span> <span style="color: #268bd2;">(</span>code-&gt;outcome <span style="color: #d33682;">(</span>nth x 1<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">]</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
The total score is still calculated in the same way, but now you need to
figure out what shape to choose so the round ends as indicated. The example
above now goes like this:
</p>

<ul class="org-ul">
<li>In the first round, your opponent will choose Rock (A), and you need the
round to end in a draw (Y), so you also choose Rock. This gives you a score
of 1 + 3 = <i>4</i>.</li>
<li>In the second round, your opponent will choose Paper (B), and you choose
Rock so you lose (X) with a score of 1 + 0 = <i>1</i>.</li>
<li>In the third round, you will defeat your opponent's Scissors with Rock for
a score of 1 + 6 = <i>7</i>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">choose-response</span> <span style="color: #d33682;">[</span>challenge outcome<span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">cond</span> <span style="color: #859900;">(</span>= outcome <span style="color: #6c71c4; font-weight: bold;">:draw</span><span style="color: #859900;">)</span> challenge
        <span style="color: #859900;">(</span>= outcome <span style="color: #6c71c4; font-weight: bold;">:win</span><span style="color: #859900;">)</span> <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">case</span> challenge
                           <span style="color: #6c71c4; font-weight: bold;">:rock</span> <span style="color: #6c71c4; font-weight: bold;">:paper</span>
                           <span style="color: #6c71c4; font-weight: bold;">:paper</span> <span style="color: #6c71c4; font-weight: bold;">:scissors</span>
                           <span style="color: #6c71c4; font-weight: bold;">:scissors</span> <span style="color: #6c71c4; font-weight: bold;">:rock</span><span style="color: #859900;">)</span>
        <span style="color: #859900;">(</span>= outcome <span style="color: #6c71c4; font-weight: bold;">:loss</span><span style="color: #859900;">)</span> <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">case</span> challenge
                            <span style="color: #6c71c4; font-weight: bold;">:rock</span> <span style="color: #6c71c4; font-weight: bold;">:scissors</span>
                            <span style="color: #6c71c4; font-weight: bold;">:scissors</span> <span style="color: #6c71c4; font-weight: bold;">:paper</span>
                            <span style="color: #6c71c4; font-weight: bold;">:paper</span> <span style="color: #6c71c4; font-weight: bold;">:rock</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
Now that you're correctly decrypting the ultra top secret strategy guide, you
would get a total score of 12.
</p>

<p>
Following the Elf's instructions for the second column, <i>what would your total
score be if everything goes exactly according to your strategy guide?</i>
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">calculated-rounds</span>
  <span style="color: #d33682;">(</span>mapv <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">fn</span> <span style="color: #6c71c4;">[</span>x<span style="color: #6c71c4;">]</span>
          <span style="color: #6c71c4;">[</span><span style="color: #35a69c;">(</span>nth x 0<span style="color: #35a69c;">)</span> <span style="color: #35a69c;">(</span>apply choose-response x<span style="color: #35a69c;">)</span><span style="color: #6c71c4;">]</span><span style="color: #859900;">)</span>
        round-strategies<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure" id="org12318af"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> calculated-rounds
     <span style="color: #d33682;">(</span>map #<span style="color: #859900;">(</span>apply play-round <span style="color: #268bd2;">%</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>map score-round<span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>reduce +<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org660cabb" class="outline-2">
<h2 id="org660cabb">Ch 3: Rucksack Reorganisation</h2>
<div class="outline-text-2" id="text-org660cabb">
<p>
One Elf has the important job of loading all of the <b>rucksacks</b> with supplies
for the jungle journey. Unfortunately, that Elf didn't quite follow the
packing instructions, and so a few items now need to be rearranged.
</p>

<p>
Each rucksack has two large <i>compartments</i>. All items of a given type are
meant to go into exactly one of the two compartments. The Elf that did the
packing failed to follow this rule for exactly one item type per rucksack.
</p>

<p>
The Elves have made a list of all of the items currently in each rucksack
(your puzzle input), but they need your help finding the errors. Every item
type is identified by a single lowercase or uppercase letter (that is, <code>a</code> and
<code>A</code> refer to different types of items).
</p>
</div>

<div id="outline-container-orgb4fbac3" class="outline-3">
<h3 id="orgb4fbac3"><span class="done DONE">DONE</span> Part One</h3>
<div class="outline-text-3" id="text-orgb4fbac3">
<p>
The list of items for each rucksack is given as characters all on a single
line. A given rucksack always has the same number of items in each of its two
compartments, so the first half of the characters represent items in the first
compartment, while the second half of the characters represent items in the
second compartment.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">day3-data</span> <span style="color: #d33682;">(</span>slurp <span style="color: #2aa198;">"resources/day3_input.txt"</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
For example, suppose you have the following list of contents from six
rucksacks:
</p>

<pre class="example" id="org9994eb0">
vJrwpWtwJgWrhcsFMMfFFhFp
jqHRNqRjqzjGDLGLrsFMfFZSrLrFZsSL
PmmdzqPrVvPwwTWBwg
wMqvLMZHhHMvwLHjbvcjnnSBnvTQFn
ttgJtRGJQctTZtZT
CrZsJsPPZsGzwwsLwLmpwMDw
</pre>

<ul class="org-ul">
<li>The first rucksack contains the items <code>vJrwpWtwJgWrhcsFMMfFFhFp</code>, which
means its first compartment contains the items <code>vJrwpWtwJgWr</code>, while the
second compartment contains the items <code>hcsFMMfFFhFp</code>. The only item type
that appears in both compartments is lowercase <i>p</i>.</li>
<li>The second rucksack's compartments contain <code>jqHRNqRjqzjGDLGL</code> and
<code>rsFMfFZSrLrFZsSL</code>. The only item type that appears in both compartments is
uppercase <i>L</i>.</li>
<li>The third rucksack's compartments contain <code>PmmdzqPrV</code> and <code>vPwwTWBwg</code>; the
only common item type is uppercase <i>P</i>.</li>
<li>The fourth rucksack's compartments only share item type <i>v</i>.</li>
<li>The fifth rucksack's compartments only share item type <i>t</i>.</li>
<li>The sixth rucksack's compartments only share item type <i>s</i>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">rucksacks</span> <span style="color: #d33682;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split-lines day3-data<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">rucksack-compartments</span>
  <span style="color: #d33682;">(</span>map <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">fn</span> <span style="color: #6c71c4;">[</span>s<span style="color: #6c71c4;">]</span> <span style="color: #6c71c4;">(</span>partition <span style="color: #35a69c;">(</span>/ <span style="color: #268bd2;">(</span>count s<span style="color: #268bd2;">)</span> 2<span style="color: #35a69c;">)</span> s<span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span> rucksacks<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
To help prioritize item rearrangement, every item type can be converted to a
priority:
</p>

<ul class="org-ul">
<li>Lowercase item types a through z have priorities 1 through 26.</li>
<li>Uppercase item types A through Z have priorities 27 through 52.</li>
</ul>

<p>
In the above example, the priority of the item type that appears in both
compartments of each rucksack is 16 (p), 38 (L), 42 (P), 22 (v), 20 (t), and
19 (s); the sum of these is 157.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">priority</span> <span style="color: #d33682;">[</span>item<span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #859900;">[</span>n <span style="color: #6c71c4;">(</span>int item<span style="color: #6c71c4;">)</span><span style="color: #859900;">]</span>
    <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">cond</span> <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">and</span> <span style="color: #35a69c;">(</span>&gt;= n <span style="color: #268bd2;">(</span>int <span style="color: #2aa198;">\a</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span> <span style="color: #35a69c;">(</span>&lt;= n <span style="color: #268bd2;">(</span>int <span style="color: #2aa198;">\z</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>- n <span style="color: #35a69c;">(</span>dec <span style="color: #268bd2;">(</span>int <span style="color: #2aa198;">\a</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span>
          <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">and</span> <span style="color: #35a69c;">(</span>&gt;= n <span style="color: #268bd2;">(</span>int <span style="color: #2aa198;">\A</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span> <span style="color: #35a69c;">(</span>&lt;= n <span style="color: #268bd2;">(</span>int <span style="color: #2aa198;">\Z</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>+ 26 <span style="color: #35a69c;">(</span>- n <span style="color: #268bd2;">(</span>dec <span style="color: #d33682;">(</span>int <span style="color: #2aa198;">\A</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span>
          <span style="color: #6c71c4; font-weight: bold;">:else</span> 0<span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
Find the item type that appears in both compartments of each rucksack. <i>What
is the sum of the priorities of those item types?</i>
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">find-duplicate-items</span> <span style="color: #d33682;">[</span>rucksacks<span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> rucksacks
       <span style="color: #859900;">(</span>map <span style="color: #6c71c4;">(</span><span style="color: #859900; font-weight: bold;">fn</span> <span style="color: #35a69c;">[</span>n<span style="color: #35a69c;">]</span>
              <span style="color: #35a69c;">(</span><span style="color: #b58900; font-style: italic;">clojure.set</span>/intersection <span style="color: #268bd2;">(</span>set <span style="color: #d33682;">(</span>nth n 0<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
                                        <span style="color: #268bd2;">(</span>set <span style="color: #d33682;">(</span>nth n 1<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">rucksack-duplicates</span> <span style="color: #d33682;">(</span>find-duplicate-items rucksack-compartments<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure" id="org4dcc457"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> rucksack-duplicates
     <span style="color: #d33682;">(</span>map #<span style="color: #859900;">(</span>map priority <span style="color: #268bd2;">%</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>map #<span style="color: #859900;">(</span>reduce + <span style="color: #268bd2;">%</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>reduce +<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org33c732f" class="outline-3">
<h3 id="org33c732f"><span class="done DONE">DONE</span> Part Two</h3>
<div class="outline-text-3" id="text-org33c732f">
<p>
As you finish identifying the misplaced items, the Elves come to you with
another issue.
</p>

<p>
The problem is that someone forgot to put this year's updated authenticity
sticker on the badges. All of the badges need to be pulled out of the
rucksacks so the new authenticity stickers can be attached.
</p>

<p>
For safety, the Elves are divided into groups of three. Every Elf carries a
badge that identifies their group. For efficiency, within each group of three
Elves, the badge is the <i>only item type carried by all three Elves</i>. That is,
if a group's badge is item type <code>B</code>, then all three Elves will have item type
<code>B</code> somewhere in their rucksack, and at most two of the Elves will be
carrying any other item type.
</p>

<p>
Additionally, nobody wrote down which item type corresponds to each group's
badges. The only way to tell which item type is the right one is by finding
the one item type that is <i>common between all three Elves</i> in each group.
</p>

<p>
Every set of three lines in your list corresponds to a single group, but each
group can have a different badge item type. So, in the above example, the
first group's rucksacks are the first three lines:
</p>

<pre class="example" id="org65274c6">
vJrwpWtwJgWrhcsFMMfFFhFp
jqHRNqRjqzjGDLGLrsFMfFZSrLrFZsSL
PmmdzqPrVvPwwTWBwg
</pre>

<p>
And the second group's rucksacks are the next three lines:
</p>

<pre class="example" id="org9cf0d0d">
wMqvLMZHhHMvwLHjbvcjnnSBnvTQFn
ttgJtRGJQctTZtZT
CrZsJsPPZsGzwwsLwLmpwMDw
</pre>

<p>
In the first group, the only item type that appears in all three rucksacks is
lowercase <code>r</code>; this must be their badges. In the second group, their badge item
type must be <code>Z</code>.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">grouped-rucksacks</span>
  <span style="color: #d33682;">(</span>partition 3 rucksacks<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
Priorities for these items must still be found to organize the sticker
attachment efforts: here, they are 18 (r) for the first group and 52 (Z) for
the second group. The sum of these is <i>70</i>.
</p>

<p>
Find the item type that corresponds to the badges of each three-Elf
group. <i>What is the sum of the priorities of those item types?</i>
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">badge-id-per-group</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> grouped-rucksacks
       <span style="color: #859900;">(</span>map #<span style="color: #6c71c4;">(</span>map set <span style="color: #268bd2;">%</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span>
       <span style="color: #859900;">(</span>map #<span style="color: #6c71c4;">(</span>apply <span style="color: #b58900; font-style: italic;">clojure.set</span>/intersection <span style="color: #268bd2;">%</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure" id="orgd75b50c"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> badge-id-per-group
     <span style="color: #d33682;">(</span>map #<span style="color: #859900;">(</span>map priority <span style="color: #268bd2;">%</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>map #<span style="color: #859900;">(</span>reduce + <span style="color: #268bd2;">%</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>reduce +<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgfae93e5" class="outline-2">
<h2 id="orgfae93e5">Ch 4: Camp Cleanup</h2>
<div class="outline-text-2" id="text-orgfae93e5">
</div>

<div id="outline-container-org7d1ad6c" class="outline-3">
<h3 id="org7d1ad6c"><span class="done DONE">DONE</span> Part One</h3>
<div class="outline-text-3" id="text-org7d1ad6c">
<p>
Space needs to be cleared before the last supplies can be unloaded from the
ships, and so several Elves have been assigned the job of cleaning up sections
of the camp. Every section has a unique <i>ID number</i>, and each Elf is assigned a
range of section IDs.
</p>

<p>
However, as some of the Elves compare their section assignments with each
other, they've noticed that many of the assignments <i>overlap</i>. To try to
quickly find overlaps and reduce duplicated effort, the Elves pair up and make
a <i>big list of the section assignments for each pair</i> (your puzzle input).
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">day4-data</span> <span style="color: #d33682;">(</span>slurp <span style="color: #2aa198;">"resources/day4_input.txt"</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">parse-assignment</span> <span style="color: #d33682;">[</span>s<span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #859900;">[</span><span style="color: #6c71c4;">[</span>l1 l2 r1 r2<span style="color: #6c71c4;">]</span>
        <span style="color: #6c71c4;">(</span>mapv #<span style="color: #35a69c;">(</span><span style="color: #b58900; font-style: italic;">Integer</span>/parseInt <span style="color: #268bd2;">%</span><span style="color: #35a69c;">)</span> <span style="color: #35a69c;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split s #<span style="color: #2aa198;">"[,-]"</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">]</span>
    <span style="color: #859900;">[</span><span style="color: #6c71c4;">[</span>l1 l2<span style="color: #6c71c4;">]</span> <span style="color: #6c71c4;">[</span>r1 r2<span style="color: #6c71c4;">]</span><span style="color: #859900;">]</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">assignments</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> <span style="color: #859900;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split-lines day4-data<span style="color: #859900;">)</span>
       <span style="color: #859900;">(</span>map parse-assignment<span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
For example, consider the following list of section assignment pairs:
</p>

<pre class="example" id="org441b22e">
2-4,6-8
2-3,4-5
5-7,7-9
2-8,3-7
6-6,4-6
2-6,4-8
</pre>

<p>
For the first few pairs, this list means:
</p>

<ul class="org-ul">
<li>Within the first pair of Elves, the first Elf was assigned sections <code>2-4</code>
(sections <code>2</code>, <code>3</code>, and <code>4</code>), while the second Elf was assigned sections
<code>6-8</code> (sections <code>6</code>, <code>7</code>, <code>8</code>).</li>
<li>The Elves in the second pair were each assigned two sections.</li>
<li>The Elves in the third pair were each assigned three sections: one got
sections <code>5</code>, <code>6</code>, and <code>7</code>, while the other also got <code>7</code>, plus <code>8</code> and <code>9</code>.</li>
</ul>

<p>
This example list uses single-digit section IDs to make it easier to draw;
your actual list might contain larger numbers. Visually, these pairs of
section assignments look like this:
</p>

<pre class="example" id="orgfda6933">
.234.....  2-4
.....678.  6-8

.23......  2-3
...45....  4-5

....567..  5-7
......789  7-9

.2345678.  2-8
..34567..  3-7

.....6...  6-6
...456...  4-6

.23456...  2-6
...45678.  4-8
</pre>

<p>
Some of the pairs have noticed that one of their assignments fully contains
the other. For example, <code>2-8</code> fully contains <code>3-7</code>, and <code>6-6</code> is fully contained by
<code>4-6</code>. In pairs where one assignment fully contains the other, one Elf in the
pair would be exclusively cleaning sections their partner will already be
cleaning, so these seem like the most in need of reconsideration. In this
example, there are 2 such pairs.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">subset?</span> <span style="color: #d33682;">[</span><span style="color: #859900;">[</span>l1 l2<span style="color: #859900;">]</span> <span style="color: #859900;">[</span>r1 r2<span style="color: #859900;">]</span><span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">and</span> <span style="color: #859900;">(</span>&gt;= r1 l1<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>&lt;= r2 l2<span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">either-subset?</span> <span style="color: #d33682;">[</span>left-range right-range<span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">or</span> <span style="color: #859900;">(</span>subset? left-range right-range<span style="color: #859900;">)</span>
      <span style="color: #859900;">(</span>subset? right-range left-range<span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>


<p>
In how many assignment pairs does one range fully contain the other?
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="orge621bc2"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> <span style="color: #d33682;">(</span>filter <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">fn</span> <span style="color: #6c71c4;">[</span><span style="color: #35a69c;">[</span>left right<span style="color: #35a69c;">]</span><span style="color: #6c71c4;">]</span> <span style="color: #6c71c4;">(</span>either-subset? left right<span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span> assignments<span style="color: #d33682;">)</span>
     count<span style="color: #268bd2;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5e4ec92" class="outline-3">
<h3 id="org5e4ec92"><span class="done DONE">DONE</span> Part Two</h3>
<div class="outline-text-3" id="text-org5e4ec92">
<p>
It seems like there is still quite a bit of duplicate work planned. Instead,
the Elves would like to know the number of pairs that <i>overlap at all</i>.
</p>

<p>
In the above example, the first two pairs (<code>2-4,6-8</code> and <code>2-3,4-5</code>) don't
overlap, while the remaining four pairs (<code>5-7,7-9</code>, <code>2-8,3-7</code>, <code>6-6,4-6</code>, and
<code>2-6,4-8</code>) do overlap:
</p>

<ul class="org-ul">
<li><code>5-7,7-9</code> overlaps in a single section, <i>7</i>.</li>
<li><code>2-8,3-7</code> overlaps all of the sections <i>3</i> through <i>7</i>.</li>
<li><code>6-6,4-6</code> overlaps in a single section, <i>6</i>.</li>
<li><code>2-6,4-8</code> overlaps in sections <i>4</i>, <i>5</i>, and <i>6</i>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">overlaps?</span> <span style="color: #d33682;">[</span><span style="color: #859900;">[</span>l1 l2<span style="color: #859900;">]</span> <span style="color: #859900;">[</span>r1 r2<span style="color: #859900;">]</span><span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">or</span> <span style="color: #859900;">(</span>&lt;= l1 r1 l2<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>&lt;= l1 r2 l2<span style="color: #859900;">)</span>
      <span style="color: #859900;">(</span>&lt;= r1 l1 r2<span style="color: #859900;">)</span> <span style="color: #859900;">(</span>&lt;= r1 l2 r2<span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
So, in this example, the number of overlapping assignment pairs is <i>4</i>.
</p>

<p>
<i>In how many assignment pairs do the ranges overlap?</i>
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="org472f7c4"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> <span style="color: #d33682;">(</span>filter <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">fn</span> <span style="color: #6c71c4;">[</span><span style="color: #35a69c;">[</span>left right<span style="color: #35a69c;">]</span><span style="color: #6c71c4;">]</span> <span style="color: #6c71c4;">(</span>overlaps? left right<span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span> assignments<span style="color: #d33682;">)</span>
     count<span style="color: #268bd2;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org966ddee" class="outline-2">
<h2 id="org966ddee">Ch 5: Supply Stacks</h2>
<div class="outline-text-2" id="text-org966ddee">
<p>
The expedition can depart as soon as the final supplies have been unloaded
from the ships. Supplies are stored in stacks of marked <i>crates</i>, but because
the needed supplies are buried under many other crates, the crates need to be
rearranged.
</p>
</div>

<div id="outline-container-orgb3d3885" class="outline-3">
<h3 id="orgb3d3885"><span class="done DONE">DONE</span> Part One</h3>
<div class="outline-text-3" id="text-orgb3d3885">
<p>
The ship has a <i>giant cargo</i> crane capable of moving crates between stacks. To
ensure none of the crates get crushed or fall over, the crane operator will
rearrange them in a series of carefully-planned steps. After the crates are
rearranged, the desired crates will be at the top of each stack.
</p>

<p>
The Elves don't want to interrupt the crane operator during this delicate
procedure, but they forgot to ask her <i>which</i> crate will end up where, and they
want to be ready to unload them as soon as possible so they can embark.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">day5-data</span> <span style="color: #d33682;">(</span>slurp <span style="color: #2aa198;">"resources/day5_input.txt"</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
They do, however, have a drawing of the starting stacks of crates <i>and</i> the
rearrangement procedure (your puzzle input). For example:
</p>

<pre class="example" id="org5888814">
    [D]
[N] [C]
[Z] [M] [P]
 1   2   3

move 1 from 2 to 1
move 3 from 1 to 3
move 2 from 2 to 1
move 1 from 1 to 2
</pre>

<p>
In this example, there are three stacks of crates. Stack 1 contains two
crates: crate <code>Z</code> is on the bottom, and crate <code>N</code> is on top. Stack 2 contains
three crates; from bottom to top, they are crates <code>M</code>, <code>C</code>, and <code>D</code>. Finally, stack
3 contains a single crate, <code>P</code>.
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">parse-stack-row</span> <span style="color: #d33682;">[</span>line<span style="color: #d33682;">]</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Split line of format '[A] [B] [C]...' by 4 to get columns.</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #859900;">[</span>parts <span style="color: #6c71c4;">(</span>partition 4 4 <span style="color: #35a69c;">[</span><span style="color: #2aa198;">\space</span><span style="color: #35a69c;">]</span> line<span style="color: #6c71c4;">)</span><span style="color: #859900;">]</span>
    <span style="color: #859900;">(</span>into <span style="color: #6c71c4;">[]</span>
          <span style="color: #6c71c4;">(</span>map <span style="color: #35a69c;">(</span><span style="color: #859900; font-weight: bold;">fn</span> <span style="color: #268bd2;">[</span>n<span style="color: #268bd2;">]</span>
                 <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Filter the letter from each part or reduce to</span>
                 <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">a single ' ' if blank.</span>
                 <span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">if</span> <span style="color: #d33682;">(</span>every? #<span style="color: #859900;">(</span>= <span style="color: #2aa198;">\space</span> <span style="color: #268bd2;">%</span><span style="color: #859900;">)</span> n<span style="color: #d33682;">)</span>
                   <span style="color: #2aa198;">\space</span>
                   <span style="color: #d33682;">(</span>first <span style="color: #859900;">(</span>filter <span style="color: #6c71c4;">(</span>set <span style="color: #2aa198;">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span style="color: #6c71c4;">)</span> n<span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span>
               parts<span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">parse-instruction</span> <span style="color: #d33682;">[</span>line<span style="color: #d33682;">]</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Convert the instruction lines 'move N from S to D' to</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">an int tuple3 of [N S D].</span>
  <span style="color: #d33682;">(</span>into <span style="color: #859900;">[]</span>
        <span style="color: #859900;">(</span>take 3 <span style="color: #6c71c4;">(</span>map #<span style="color: #35a69c;">(</span><span style="color: #b58900; font-style: italic;">Integer</span>/parseInt <span style="color: #268bd2;">%</span><span style="color: #35a69c;">)</span>
                     <span style="color: #35a69c;">(</span>re-seq #<span style="color: #2aa198;">"</span><span style="color: #2aa198; font-weight: bold;">\d</span><span style="color: #2aa198;">+"</span> line<span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">transpose-stacks</span> <span style="color: #d33682;">[</span>stacks<span style="color: #d33682;">]</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Convert the vertical stack string representation to an array</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">of stacks (linked list so conj/take operate on front.</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">for</span> <span style="color: #859900;">[</span>x <span style="color: #6c71c4;">(</span>range <span style="color: #35a69c;">(</span>count <span style="color: #268bd2;">(</span>first stacks<span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">]</span>
    <span style="color: #859900;">(</span>remove #<span style="color: #6c71c4;">(</span>= <span style="color: #2aa198;">\space</span> <span style="color: #268bd2;">%</span><span style="color: #6c71c4;">)</span> <span style="color: #6c71c4;">(</span>map #<span style="color: #35a69c;">(</span>nth <span style="color: #268bd2;">%</span> x<span style="color: #35a69c;">)</span> stacks<span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> <span style="color: #268bd2;">day5-parsed-data</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #859900;">[</span>lines <span style="color: #6c71c4;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/split-lines day5-data<span style="color: #6c71c4;">)</span><span style="color: #859900;">]</span>
    <span style="color: #859900;">{</span><span style="color: #6c71c4; font-weight: bold;">:crates</span> <span style="color: #6c71c4;">(</span>into <span style="color: #35a69c;">[]</span>
                   <span style="color: #35a69c;">(</span>transpose-stacks
                    <span style="color: #268bd2;">(</span>map parse-stack-row
                         <span style="color: #d33682;">(</span>filter #<span style="color: #859900;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/includes? <span style="color: #268bd2;">%</span> <span style="color: #2aa198;">"["</span><span style="color: #859900;">)</span>
                                 lines<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span>
     <span style="color: #6c71c4; font-weight: bold;">:instructions</span> <span style="color: #6c71c4;">(</span>into <span style="color: #35a69c;">[]</span>
                         <span style="color: #35a69c;">(</span>map parse-instruction
                              <span style="color: #268bd2;">(</span>filter #<span style="color: #d33682;">(</span><span style="color: #b58900; font-style: italic;">clojure.string</span>/includes? <span style="color: #268bd2;">%</span> <span style="color: #2aa198;">"move"</span><span style="color: #d33682;">)</span>
                                      lines<span style="color: #268bd2;">)</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">}</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
In the parsed data struct then, <code>:crates</code> is a vector of the stacks from 0..n,
and <code>:instructions</code> is a list of tuples of the form <code>[count from to]</code>.
</p>

<p>
Then, the rearrangement procedure is given. In each step of the procedure, a
quantity of crates is moved from one stack to a different stack. In the first
step of the above rearrangement procedure, one crate is moved from stack 2 to
stack 1, resulting in this configuration:
</p>

<pre class="example" id="org4f3983d">
[D]
[N] [C]
[Z] [M] [P]
 1   2   3
</pre>

<p>
In the second step, three crates are moved from stack 1 to stack 3. Crates are
moved <i>one at a time</i>, so the first crate to be moved (<code>D</code>) ends up below the
second and third crates:
</p>

<pre class="example" id="org517ca89">
       [Z]
       [N]
   [C] [D]
   [M] [P]
1   2   3
</pre>

<p>
Then, both crates are moved from stack 2 to stack 1. Again, because crates are
moved <i>one at a time</i>, crate <code>C</code> ends up below crate <code>M</code>:
</p>

<pre class="example" id="org2437565">
        [Z]
        [N]
[M]     [D]
[C]     [P]
 1   2   3
</pre>

<p>
Finally, one crate is moved from stack 1 to stack 2:
</p>

<pre class="example" id="org43f0108">
        [Z]
        [N]
        [D]
[C] [M] [P]
 1   2   3
</pre>

<p>
The Elves just need to know which crate will end up on top of each stack; in
this example, the top crates are <code>C</code> in stack 1, <code>M</code> in stack 2, and <code>Z</code> in stack 3,
so you should combine these together and give the Elves the message <code>CMZ</code>.
</p>

<p>
The generic operation here is that we will transform the stack of crates by
performing the sequence of instructions successively on each new iteration. If
we parameterize the step function, we can separately define what a single
instruction must do, given the rules of the CrateMover-9000:
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">run-all</span> <span style="color: #d33682;">[</span>step-fn crates instructions<span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span>reduce step-fn crates instructions<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>

<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">run-step-cm9000</span> <span style="color: #d33682;">[</span>crates <span style="color: #859900;">[</span>n from to<span style="color: #859900;">]</span><span style="color: #d33682;">]</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Note: from,to are 1-indexed in the data.</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #859900;">[</span>from <span style="color: #6c71c4;">(</span>dec from<span style="color: #6c71c4;">)</span>
        to <span style="color: #6c71c4;">(</span>dec to<span style="color: #6c71c4;">)</span>
        taken <span style="color: #6c71c4;">(</span>take n <span style="color: #35a69c;">(</span>nth crates from<span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">]</span>
    <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">-&gt;</span> crates
        <span style="color: #6c71c4;">(</span>update-in <span style="color: #35a69c;">[</span>from<span style="color: #35a69c;">]</span> #<span style="color: #35a69c;">(</span>drop n <span style="color: #268bd2;">%</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span>
        <span style="color: #6c71c4;">(</span>update-in <span style="color: #35a69c;">[</span>to<span style="color: #35a69c;">]</span> #<span style="color: #35a69c;">(</span>concat <span style="color: #268bd2;">(</span>reverse taken<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">%</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
<i>After the rearrangement procedure completes, what crate ends up on top of
each stack?</i>
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span>run-all run-step-cm9000
         <span style="color: #d33682;">(</span><span style="color: #6c71c4; font-weight: bold;">:crates</span> day5-parsed-data<span style="color: #d33682;">)</span>
         <span style="color: #d33682;">(</span><span style="color: #6c71c4; font-weight: bold;">:instructions</span> day5-parsed-data<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure" id="org68973f4"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> <span style="color: #d33682;">(</span>run-all run-step-cm9000
              <span style="color: #859900;">(</span><span style="color: #6c71c4; font-weight: bold;">:crates</span> day5-parsed-data<span style="color: #859900;">)</span>
              <span style="color: #859900;">(</span><span style="color: #6c71c4; font-weight: bold;">:instructions</span> day5-parsed-data<span style="color: #859900;">)</span><span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>map first<span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>apply str<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcde1b4e" class="outline-3">
<h3 id="orgcde1b4e"><span class="done DONE">DONE</span> Part Two</h3>
<div class="outline-text-3" id="text-orgcde1b4e">
<p>
As you watch the crane operator expertly rearrange the crates, you notice the
process isn't following your prediction.
</p>

<p>
Some mud was covering the writing on the side of the crane, and you quickly
wipe it away. The crane isn't a CrateMover 9000 - it's a <i>CrateMover 9001</i>.
</p>

<p>
The CrateMover 9001 is notable for many new and exciting features: air
conditioning, leather seats, an extra cup holder, and <i>the ability to pick up
and move multiple crates at once.</i>
</p>

<p>
Again considering the example above, the crates begin in the same
configuration:
</p>

<pre class="example" id="org76cff1a">
    [D]
[N] [C]
[Z] [M] [P]
 1   2   3
</pre>

<p>
Moving a single crate from stack 2 to stack 1 behaves the same as before:
</p>

<pre class="example" id="org4cea093">
[D]
[N] [C]
[Z] [M] [P]
 1   2   3
</pre>

<p>
However, the action of moving three crates from stack 1 to stack 3 means
that those three moved crates stay in the same order, resulting in this new
configuration:
</p>

<pre class="example" id="org7aa2478">
       [D]
       [N]
   [C] [Z]
   [M] [P]
1   2   3
</pre>

<p>
Next, as both crates are moved from stack 2 to stack 1, they retain their
order as well:
</p>

<pre class="example" id="org41f6712">
        [D]
        [N]
[C]     [Z]
[M]     [P]
 1   2   3
</pre>

<p>
Finally, a single crate is still moved from stack 1 to stack 2, but now it's
crate <code>C</code> that gets moved:
</p>

<pre class="example" id="orgcc34f6a">
        [D]
        [N]
        [Z]
[M] [C] [P]
 1   2   3
</pre>

<p>
In this example, the CrateMover 9001 has put the crates in a totally
different order: <code>MCD</code>.
</p>

<p>
Before the rearrangement process finishes, update your simulation so that the
Elves know where they should stand to be ready to unload the final
supplies. After the rearrangement procedure completes, what crate ends up on
top of each stack?
</p>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">run-step-cm9001</span> <span style="color: #d33682;">[</span>crates <span style="color: #859900;">[</span>n from to<span style="color: #859900;">]</span><span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span><span style="color: #859900; font-weight: bold;">let</span> <span style="color: #859900;">[</span>from <span style="color: #6c71c4;">(</span>dec from<span style="color: #6c71c4;">)</span>
        to <span style="color: #6c71c4;">(</span>dec to<span style="color: #6c71c4;">)</span>
        taken <span style="color: #6c71c4;">(</span>take n <span style="color: #35a69c;">(</span>nth crates from<span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">]</span>
    <span style="color: #859900;">(</span><span style="color: #859900; font-weight: bold;">-&gt;</span> crates
        <span style="color: #6c71c4;">(</span>update-in <span style="color: #35a69c;">[</span>from<span style="color: #35a69c;">]</span> #<span style="color: #35a69c;">(</span>drop n <span style="color: #268bd2;">%</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span>
        <span style="color: #6c71c4;">(</span>update-in <span style="color: #35a69c;">[</span>to<span style="color: #35a69c;">]</span> #<span style="color: #35a69c;">(</span>concat taken <span style="color: #268bd2;">%</span><span style="color: #35a69c;">)</span><span style="color: #6c71c4;">)</span><span style="color: #859900;">)</span><span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure"><span style="color: #268bd2;">(</span>run-all run-step-cm9001
         <span style="color: #d33682;">(</span><span style="color: #6c71c4; font-weight: bold;">:crates</span> day5-parsed-data<span style="color: #d33682;">)</span>
         <span style="color: #d33682;">(</span><span style="color: #6c71c4; font-weight: bold;">:instructions</span> day5-parsed-data<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure" id="org398a0f3"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">-&gt;&gt;</span> <span style="color: #d33682;">(</span>run-all run-step-cm9001
              <span style="color: #859900;">(</span><span style="color: #6c71c4; font-weight: bold;">:crates</span> day5-parsed-data<span style="color: #859900;">)</span>
              <span style="color: #859900;">(</span><span style="color: #6c71c4; font-weight: bold;">:instructions</span> day5-parsed-data<span style="color: #859900;">)</span><span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>map first<span style="color: #d33682;">)</span>
     <span style="color: #d33682;">(</span>apply str<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org870090d" class="outline-2">
<h2 id="org870090d">Ch 6: &#x2026;</h2>
<div class="outline-text-2" id="text-org870090d">
</div>
</div>

<div id="outline-container-org85c3d85" class="outline-2">
<h2 id="org85c3d85">Ch 7: &#x2026;</h2>
<div class="outline-text-2" id="text-org85c3d85">
</div>
</div>

<div id="outline-container-org58001d9" class="outline-2">
<h2 id="org58001d9">Ch 8: &#x2026;</h2>
<div class="outline-text-2" id="text-org58001d9">
</div>
</div>

<div id="outline-container-orgbc540f5" class="outline-2">
<h2 id="orgbc540f5">Ch 9: &#x2026;</h2>
<div class="outline-text-2" id="text-orgbc540f5">
</div>
</div>

<div id="outline-container-orgbc1c6b7" class="outline-2">
<h2 id="orgbc1c6b7">Ch 10: &#x2026;</h2>
<div class="outline-text-2" id="text-orgbc1c6b7">
</div>
</div>

<div id="outline-container-org0f842fc" class="outline-2">
<h2 id="org0f842fc">Ch 11: &#x2026;</h2>
</div>

<div id="outline-container-orga79e3f3" class="outline-2">
<h2 id="orga79e3f3">Ch 12: &#x2026;</h2>
</div>

<div id="outline-container-org83bbe6c" class="outline-2">
<h2 id="org83bbe6c">Ch 13: &#x2026;</h2>
</div>

<div id="outline-container-orgeff7887" class="outline-2">
<h2 id="orgeff7887">Ch 14: &#x2026;</h2>
</div>

<div id="outline-container-org43d70c8" class="outline-2">
<h2 id="org43d70c8">Ch 15: &#x2026;</h2>
</div>

<div id="outline-container-org562057c" class="outline-2">
<h2 id="org562057c">Ch 16: &#x2026;</h2>
</div>

<div id="outline-container-org1864728" class="outline-2">
<h2 id="org1864728">Ch 17: &#x2026;</h2>
</div>

<div id="outline-container-orgc9a17c3" class="outline-2">
<h2 id="orgc9a17c3">Ch 18: &#x2026;</h2>
</div>

<div id="outline-container-orgc8529bd" class="outline-2">
<h2 id="orgc8529bd">Ch 19: &#x2026;</h2>
</div>

<div id="outline-container-orgaf2ba77" class="outline-2">
<h2 id="orgaf2ba77">Ch 20: &#x2026;</h2>
</div>

<div id="outline-container-orgede2c3e" class="outline-2">
<h2 id="orgede2c3e">Ch 21: &#x2026;</h2>
</div>

<div id="outline-container-org1ef22bd" class="outline-2">
<h2 id="org1ef22bd">Ch 22: &#x2026;</h2>
</div>

<div id="outline-container-orgb984390" class="outline-2">
<h2 id="orgb984390">Ch 23: &#x2026;</h2>
</div>

<div id="outline-container-org179240e" class="outline-2">
<h2 id="org179240e">Ch 24: &#x2026;</h2>
</div>

<div id="outline-container-org32a61c7" class="outline-2">
<h2 id="org32a61c7">Ch 25: &#x2026;</h2>
</div>


<div id="outline-container-org2a62123" class="outline-2">
<h2 id="org2a62123">References</h2>
<div class="outline-text-2" id="text-org2a62123">
<p>
List any support references, interesting reading.
</p>
</div>
</div>

<div id="outline-container-org0a10fe1" class="outline-2">
<h2 id="org0a10fe1">Appendix A: Helper Definitions</h2>
<div class="outline-text-2" id="text-org0a10fe1">
<p>
Additional boilerplate code. Probably namespace declarations will live down
here and not interfere with the readability of the narrative problems.
</p>
</div>
</div>

<div id="outline-container-orgf55527b" class="outline-2">
<h2 id="orgf55527b">Appendix B: Example Chapter</h2>
<div class="outline-text-2" id="text-orgf55527b">
<p>
For a definition of constant data, we don't need to echo the results back to
the buffer, it's fine that they are sent to the Clojure REPL.
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="org1ba70d2"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">def</span> ^<span style="color: #6c71c4; font-weight: bold;">:const</span> <span style="color: #268bd2;">numbers</span> <span style="color: #d33682;">[</span>3, 7, 12, 8, 23<span style="color: #d33682;">]</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
Similarly, when defining a named function we can be satisfied that it exists
in Clojure. All the result block would echo is the package and symbol name.
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="orgc32cdfe"><span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">defn</span> <span style="color: #b58900;">add-two-numbers</span> <span style="color: #d33682;">[</span>a b<span style="color: #d33682;">]</span>
  <span style="color: #d33682;">(</span>+ a b<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
When we want to query something or call a function, the default <code>:results</code>
type will be the value of the expression. Alternatively we could specify
<code>:results output</code> if we want to instead capture anything sent to
<code>*standard-output*</code>.
</p>

<div class="org-src-container">
<pre class="src src-clojure" id="org65a10bb"><span style="color: #268bd2;">(</span>map <span style="color: #d33682;">(</span>partial add-two-numbers 5<span style="color: #d33682;">)</span> numbers<span style="color: #268bd2;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-clojure" id="orgc3275f6"><span style="color: #268bd2;">(</span>printf <span style="color: #2aa198;">"Sum of numbers: %d"</span>
        <span style="color: #d33682;">(</span>reduce add-two-numbers numbers<span style="color: #d33682;">)</span><span style="color: #268bd2;">)</span>
</pre>
</div>

<p>
And that's pretty much as simple as I'll try to keep things.
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2022-11-28 Mon 15:14</p>
<p class="author">Author: Stu</p>
<p class="date">Created: 2022-12-05 Mon 16:51</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
